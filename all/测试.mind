{"root":{"data":{"id":"dcb4rbus9ig0","created":1756086636831,"text":"springboot-test","resource":["é—®é—®"]},"children":[{"data":{"id":"dcb4ri40sl40","created":1756086650450,"text":"junit","layout_mind_offset":{"x":9,"y":-15}},"children":[]},{"data":{"id":"dcb4rkf1fmw0","created":1756086655470,"text":"Mockito"},"children":[]},{"data":{"id":"dcb52dcspvs0","created":1756087502103,"text":"å•å…ƒï¼Œé›†æˆï¼Œåˆ†å±‚æµ‹è¯•","note":"åœ¨ Spring Boot ä¸­ï¼Œâ€œå•å…ƒæµ‹è¯•â€ï¼ˆUnit Testï¼‰å’Œâ€œé›†æˆæµ‹è¯•â€ï¼ˆIntegration Testï¼‰æœ‰ä¸åŒçš„å®ç°æ–¹å¼ã€‚ä½ æåˆ°çš„æ˜¯**å•å…ƒæµ‹è¯•**ï¼Œå®ƒçš„æ ¸å¿ƒç›®æ ‡æ˜¯ï¼š**éš”ç¦»æµ‹è¯•æŸä¸ªç±»æˆ–æ–¹æ³•ï¼Œä¸ä¾èµ– Spring å®¹å™¨æˆ–å¤–éƒ¨ç»„ä»¶ï¼ˆå¦‚æ•°æ®åº“ã€ç½‘ç»œç­‰ï¼‰**ã€‚\n\n---\n\n## âœ… ä¸€ã€ä»€ä¹ˆæ˜¯ Spring Boot çš„â€œå•å…ƒæµ‹è¯•â€ï¼Ÿ\n\n- **ç›®æ ‡**ï¼šåªæµ‹è¯•ä¸€ä¸ªç±»çš„é€»è¾‘ï¼Œæ¯”å¦‚ `UserService` ä¸­çš„æŸä¸ªæ–¹æ³•ã€‚\n- **åŸåˆ™**ï¼šä¸åŠ è½½ Spring ä¸Šä¸‹æ–‡ï¼Œä¸è¿æ¥æ•°æ®åº“ï¼Œä¸å¯åŠ¨ Web æœåŠ¡å™¨ã€‚\n- **å·¥å…·**ï¼šä½¿ç”¨ JUnit + Mockitoï¼ˆæˆ–å…¶ä»– Mock æ¡†æ¶ï¼‰æ¥æ¨¡æ‹Ÿä¾èµ–ã€‚\n\n> âš ï¸ æ³¨æ„ï¼šå¾ˆå¤šäººè¯¯æŠŠ `@SpringBootTest` å½“ä½œâ€œå•å…ƒæµ‹è¯•â€ï¼Œå…¶å®å®ƒæ˜¯**é›†æˆæµ‹è¯•**ã€‚çœŸæ­£çš„å•å…ƒæµ‹è¯•åº”è¯¥æ˜¯è½»é‡ã€å¿«é€Ÿã€æ— ä¾èµ–çš„ã€‚\n\n---\n\n## âœ… äºŒã€å•å…ƒæµ‹è¯•çš„å®ç°æ­¥éª¤\n\n### æ­¥éª¤ 1ï¼šæ·»åŠ ä¾èµ–ï¼ˆé€šå¸¸å·²åŒ…å«ï¼‰\n\n```xml\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-test</artifactId>\n    <scope>test</scope>\n</dependency>\n```\n\nå®ƒåŒ…å«äº†ï¼š\n- JUnit 4 æˆ– JUnit 5\n- Mockito\n- Spring Test\n- AssertJ\n- Hamcrest\n- JSONassert\n- JsonPath\n\n---\n\n### æ­¥éª¤ 2ï¼šç¼–å†™è¢«æµ‹ç±»\n\n```java\n// src/main/java/com/example/service/UserService.java\npackage com.example.service;\n\nimport com.example.repository.UserRepository;\nimport com.example.entity.User;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Service;\n\n@Service\npublic class UserService {\n\n    private final UserRepository userRepository;\n\n    // æ„é€ å™¨æ³¨å…¥ï¼ˆæ¨èç”¨äºå•å…ƒæµ‹è¯•ï¼‰\n    public UserService(UserRepository userRepository) {\n        this.userRepository = userRepository;\n    }\n\n    public User createUser(String name, Integer age) {\n        if (name == null || name.trim().isEmpty()) {\n            throw new IllegalArgumentException(\"Name cannot be null or empty\");\n        }\n        User user = new User(name, age);\n        return userRepository.save(user); // ä¾èµ–å¤–éƒ¨ç»„ä»¶\n    }\n\n    public String getUserInfo(String name) {\n        return \"User: \" + name.toUpperCase();\n    }\n}\n```\n\n---\n\n### æ­¥éª¤ 3ï¼šç¼–å†™å•å…ƒæµ‹è¯•ï¼ˆä¸åŠ è½½ Spring ä¸Šä¸‹æ–‡ï¼‰\n\n```java\n// src/test/java/com/example/service/UserServiceUnitTest.java\npackage com.example.service;\n\nimport com.example.entity.User;\nimport com.example.repository.UserRepository;\nimport org.junit.Before;\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.mockito.Mock;\nimport org.mockito.junit.MockitoJUnitRunner;\n\nimport static org.junit.Assert.*;\nimport static org.mockito.Mockito.*;\n\n/**\n * å•å…ƒæµ‹è¯•ï¼šåªæµ‹è¯• UserService çš„é€»è¾‘ï¼Œä¸åŠ è½½ Spring ä¸Šä¸‹æ–‡\n */\n@RunWith(MockitoJUnitRunner.class)  // å¯ç”¨ Mockito æ³¨è§£æ”¯æŒ\npublic class UserServiceUnitTest {\n\n    @Mock  // æ¨¡æ‹Ÿä¾èµ–\n    private UserRepository userRepository;\n\n    private UserService userService;\n\n    @Before\n    public void setUp() {\n        // æ‰‹åŠ¨åˆ›å»º UserServiceï¼Œå¹¶æ³¨å…¥ mock çš„ä¾èµ–\n        userService = new UserService(userRepository);\n    }\n\n    @Test\n    public void shouldCreateUserWhenNameIsValid() {\n        // å‡†å¤‡æ¨¡æ‹Ÿè¡Œä¸º\n        User savedUser = new User(\"Alice\", 25);\n        savedUser.setId(\"123\");\n        when(userRepository.save(any(User.class))).thenReturn(savedUser);\n\n        // è°ƒç”¨è¢«æµ‹æ–¹æ³•\n        User result = userService.createUser(\"Alice\", 25);\n\n        // éªŒè¯ç»“æœ\n        assertNotNull(result);\n        assertEquals(\"123\", result.getId());\n        assertEquals(\"Alice\", result.getName());\n\n        // éªŒè¯æ˜¯å¦è°ƒç”¨äº† save æ–¹æ³•\n        verify(userRepository, times(1)).save(any(User.class));\n    }\n\n    @Test(expected = IllegalArgumentException.class)\n    public void shouldThrowExceptionWhenNameIsNull() {\n        userService.createUser(null, 20);\n    }\n\n    @Test\n    public void shouldReturnUpperCaseUserInfo() {\n        // è¿™ä¸ªæ–¹æ³•ä¸ä¾èµ–å¤–éƒ¨ç»„ä»¶ï¼Œå¯ä»¥ç›´æ¥æµ‹è¯•\n        String info = userService.getUserInfo(\"bob\");\n        assertEquals(\"User: BOB\", info);\n    }\n}\n```\n\n---\n\n## âœ… ä¸‰ã€å…³é”®ç‚¹è¯´æ˜\n\n| æŠ€æœ¯ | ä½œç”¨ |\n|------|------|\n| `@RunWith(MockitoJUnitRunner.class)` | å¯ç”¨ Mockito çš„ `@Mock`ã€`@InjectMocks` ç­‰æ³¨è§£ |\n| `@Mock` | åˆ›å»ºä¸€ä¸ª mock å¯¹è±¡ï¼ˆæ¨¡æ‹Ÿè¡Œä¸ºï¼‰ |\n| `when(...).thenReturn(...)` | å®šä¹‰ mock å¯¹è±¡çš„è¿”å›å€¼ |\n| `verify(...)` | éªŒè¯æŸä¸ªæ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨ |\n| **ä¸ä½¿ç”¨ `@SpringBootTest`** | é¿å…åŠ è½½ Spring ä¸Šä¸‹æ–‡ï¼Œä¿æŒæµ‹è¯•è½»é‡ |\n\n---\n\n## âœ… å››ã€å•å…ƒæµ‹è¯• vs é›†æˆæµ‹è¯• å¯¹æ¯”\n\n| ç‰¹æ€§ | å•å…ƒæµ‹è¯•ï¼ˆUnit Testï¼‰ | é›†æˆæµ‹è¯•ï¼ˆIntegration Testï¼‰ |\n|------|------------------------|------------------------------|\n| æ˜¯å¦åŠ è½½ Spring ä¸Šä¸‹æ–‡ | âŒ å¦ | âœ… æ˜¯ï¼ˆç”¨ `@SpringBootTest`ï¼‰ |\n| æ˜¯å¦è¿æ¥æ•°æ®åº“ | âŒ å¦ï¼ˆç”¨ `@MockBean` æ¨¡æ‹Ÿï¼‰ | âœ… æ˜¯ï¼ˆçœŸå®æ“ä½œï¼‰ |\n| é€Ÿåº¦ | âš¡ å¾ˆå¿«ï¼ˆæ¯«ç§’çº§ï¼‰ | ğŸ¢ è¾ƒæ…¢ï¼ˆç§’çº§ï¼‰ |\n| é€‚ç”¨åœºæ™¯ | æµ‹è¯•å•ä¸ªç±»çš„ä¸šåŠ¡é€»è¾‘ | æµ‹è¯•å¤šä¸ªç»„ä»¶ååŒå·¥ä½œ |\n| ä¾èµ– | JUnit + Mockito | JUnit + Spring Test + Spring Context |\n\n---\n\n## âœ… äº”ã€å…¶ä»–å¸¸è§å•å…ƒæµ‹è¯•åœºæ™¯\n\n### 1. æµ‹è¯• Controller å±‚ï¼ˆä¸å¯åŠ¨ Web å®¹å™¨ï¼‰\n\n```java\n@Test\npublic void shouldReturnUserWhenValidId() {\n    when(userService.findById(1L)).thenReturn(new User(\"Alice\", 25));\n\n    User result = userController.getUser(1L);\n\n    assertEquals(\"Alice\", result.getName());\n}\n```\n\n### 2. æµ‹è¯•å·¥å…·ç±»ï¼ˆçº¯ Java ç±»ï¼‰\n\n```java\n@Test\npublic void shouldFormatDateCorrectly() {\n    String result = DateUtils.format(LocalDate.of(2025, 1, 1));\n    assertEquals(\"2025-01-01\", result);\n}\n```\n\n---\n\n## âœ… å…­ã€æœ€ä½³å®è·µ\n\n1. **ä¼˜å…ˆå†™å•å…ƒæµ‹è¯•**ï¼šå¿«é€Ÿã€ç¨³å®šã€æ˜“äºè°ƒè¯•ã€‚\n2. **ä½¿ç”¨æ„é€ å™¨æ³¨å…¥**ï¼šä¾¿äºåœ¨æµ‹è¯•ä¸­æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡ã€‚\n3. **é¿å… `new` å¤–éƒ¨ä¾èµ–**ï¼šå¦åˆ™æ— æ³• mockã€‚\n4. **æµ‹è¯•è¾¹ç•Œæ¡ä»¶**ï¼šç©ºå€¼ã€å¼‚å¸¸ã€æç«¯å€¼ã€‚\n5. **ä¿æŒæµ‹è¯•ç‹¬ç«‹**ï¼šæ¯ä¸ªæµ‹è¯•æ–¹æ³•åº”ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¾èµ–é¡ºåºã€‚\n\n---\n\n## âœ… ä¸ƒã€æ€»ç»“\n\n| é—®é¢˜ | å›ç­” |\n|------|------|\n| Spring Boot å•å…ƒæµ‹è¯•å¦‚ä½•å®ç°ï¼Ÿ | ä½¿ç”¨ **JUnit + Mockito**ï¼Œ**ä¸åŠ è½½ Spring ä¸Šä¸‹æ–‡**ï¼Œ**mock å¤–éƒ¨ä¾èµ–** |\n| æ˜¯å¦ä½¿ç”¨ `@SpringBootTest`ï¼Ÿ | âŒ ä¸ä½¿ç”¨ï¼ˆé‚£æ˜¯é›†æˆæµ‹è¯•ï¼‰ |\n| æ ¸å¿ƒå·¥å…·æ˜¯ä»€ä¹ˆï¼Ÿ | `@Mock`, `when().thenReturn()`, `verify()` |\n| ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ | å¿«é€Ÿã€éš”ç¦»åœ°æµ‹è¯•å•ä¸ªç±»çš„é€»è¾‘ |\n\nâœ… æ‰€ä»¥ï¼ŒçœŸæ­£çš„ Spring Boot **å•å…ƒæµ‹è¯•**æ˜¯ï¼š\n> **è½»é‡ã€å¿«é€Ÿã€æ—  Spring å®¹å™¨ã€ä¾èµ– Mock çš„æµ‹è¯•æ–¹å¼**ã€‚\n\nå¦‚æœä½ éœ€è¦æµ‹è¯•æ•°æ®åº“ã€Web æ¥å£ç­‰çœŸå®äº¤äº’ï¼Œè¯·ä½¿ç”¨ `@SpringBootTest` â€”â€” ä½†é‚£å·²ç»æ˜¯**é›†æˆæµ‹è¯•**äº†ã€‚","layout_mind_offset":{"x":-33,"y":0}},"children":[{"data":{"id":"dcb5pd31y000","created":1756089303890,"text":"å•å…ƒæµ‹è¯•æµ‹è¯•é€»è¾‘"},"children":[]},{"data":{"id":"dcb5pq02gvs0","created":1756089332007,"text":"é›†æˆæµ‹è¯•æµ‹è¯•å„ä¸ªä¾èµ–çš„ç¨³å®šæ€§"},"children":[]}]},{"data":{"id":"dcb4y738srs0","created":1756087175008,"text":"å®Œæ•´ä¸Šä¸‹æ–‡"},"children":[]},{"data":{"id":"dcb4yeeurmw0","created":1756087190947,"text":"å±€éƒ¨ä¸Šä¸‹æ–‡"},"children":[]},{"data":{"id":"dcb4ylhboyg0","created":1756087206334,"text":"åˆ†æ”¯ä¸»é¢˜"},"children":[]}]},"template":"default","theme":"fresh-blue","version":"1.4.43"}